From ce01bf795b5a50e28e119d1925b395b8bfcf419b Mon Sep 17 00:00:00 2001
From: =?utf8?q?J=C3=BCri=20Valdmann?= <juri.valdmann@qt.io>
Date: Tue, 15 May 2018 16:21:04 +0200
Subject: [PATCH] Remove old focusProxy widget from layout in
 RWHVQDW::initAsChild

Task-number: QTBUG-68224
Change-Id: I317915f0c81531e5858dfa3a76365b16266ce919
Reviewed-by: Allan Sandfeld Jensen <allan.jensen@qt.io>
---
 src/webenginewidgets/render_widget_host_view_qt_delegate_widget.cpp | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/webenginewidgets/render_widget_host_view_qt_delegate_widget.cpp b/src/webenginewidgets/render_widget_host_view_qt_delegate_widget.cpp
index 16ea216f2..56f04d424 100644
--- a/src/webenginewidgets/render_widget_host_view_qt_delegate_widget.cpp
+++ b/src/webenginewidgets/render_widget_host_view_qt_delegate_widget.cpp
@@ -198,6 +198,9 @@ void RenderWidgetHostViewQtDelegateWidget::initAsChild(WebContentsAdapterClient*
             disconnect(parentWidget(), &QObject::destroyed,
                 this, &RenderWidgetHostViewQtDelegateWidget::removeParentBeforeParentDelete);
         pagePrivate->view->layout()->addWidget(this);
+        if (QWidget *focusProxy = pagePrivate->view->focusProxy())
+            if (focusProxy != this)
+                pagePrivate->view->layout()->removeWidget(focusProxy);
         pagePrivate->view->setFocusProxy(this);
         show();
     } else
-- 
2.16.3
